<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forge3D Planner - Intelig√™ncia para Impress√£o 3D</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'lore-paper': '#f5f5f0',
                        'lore-dark': '#1a202c',
                        'lore-accent': '#d97706',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f8f8f2; color: #2d3748; scroll-behavior: smooth; }
        .gemini-gradient { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #d97706 100%); }
        .loading-spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid #fff;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .image-container { aspect-ratio: 16 / 9; width: 100%; border-radius: 1rem; overflow: hidden; background: #000; position: relative; }
        .image-container img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body class="font-sans antialiased">

    <!-- Config Modal -->
    <div id="api-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center hidden">
        <div class="bg-white p-8 rounded-2xl max-w-md w-full mx-4 shadow-2xl">
            <h3 class="text-2xl font-display font-bold mb-4">Configurar Chave API</h3>
            <p class="text-sm text-gray-600 mb-6">Para usar as fun√ß√µes de IA e manter sua seguran√ßa no GitHub, insira sua chave do Google AI Studio abaixo. Ela ser√° salva apenas no seu navegador.</p>
            <input type="password" id="api-key-input" placeholder="Cole sua chave aqui..." class="w-full border border-gray-300 rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-lore-accent focus:outline-none">
            <div class="flex gap-3">
                <button onclick="saveApiKey()" class="flex-grow bg-lore-accent text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition">Salvar Chave</button>
                <button onclick="toggleModal(false)" class="px-6 text-gray-500 font-medium">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Nav -->
    <nav class="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <span class="text-2xl font-display font-bold text-lore-dark">Forge<span class="text-lore-accent">3D</span></span>
                <div class="hidden md:flex space-x-6">
                    <button onclick="scrollToSection('strategy')" class="text-sm font-medium hover:text-lore-accent">Estrat√©gia</button>
                    <button onclick="scrollToSection('ai-center')" class="text-sm font-medium text-indigo-600 font-bold">IA Visual</button>
                    <button onclick="scrollToSection('calculator')" class="text-sm font-medium hover:text-lore-accent">Calculadora</button>
                </div>
                <button onclick="toggleModal(true)" class="bg-gray-100 p-2 rounded-lg hover:bg-gray-200 transition" title="Configura√ß√µes">‚öôÔ∏è</button>
            </div>
        </div>
    </nav>

    <!-- Main -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24">

        <!-- Hero -->
        <section class="text-center">
            <h1 class="text-4xl md:text-6xl font-display font-bold text-lore-dark mb-6 leading-tight">
                Transforme sua Impress√£o 3D em <br><span class="text-lore-accent">R$ 6.600,00 Mensais</span>
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Estrat√©gia focada em <strong>Lore & Artefatos</strong>. Menos "bonequinhos", mais valor percebido e exclusividade.
            </p>
        </section>

        <!-- AI Center -->
        <section id="ai-center" class="scroll-mt-24">
            <div class="gemini-gradient p-6 md:p-12 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden">
                <div class="relative z-10">
                    <div class="flex flex-col lg:flex-row justify-between items-start gap-12">
                        
                        <!-- Left side: Text Tools -->
                        <div class="w-full lg:w-1/2 space-y-8">
                            <div>
                                <h2 class="text-3xl font-display font-bold mb-2">Central de Intelig√™ncia Lore</h2>
                                <p class="text-indigo-100 italic">Crie produtos √∫nicos e narrativas nost√°lgicas.</p>
                            </div>

                            <div class="bg-white/10 p-6 rounded-2xl border border-white/20">
                                <label class="block text-xs font-bold uppercase tracking-widest text-indigo-200 mb-2">Tema do Artefato</label>
                                <div class="flex gap-2 mb-4">
                                    <input type="text" id="lore-theme" placeholder="Ex: Medieval G√≥tico, Steampunk..." class="flex-grow bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-indigo-300 focus:ring-2 focus:ring-amber-400 focus:outline-none">
                                    <button onclick="generateText('lore')" id="btn-lore" class="bg-amber-500 hover:bg-amber-600 px-6 rounded-xl font-bold transition flex items-center justify-center">
                                        <div id="loader-lore" class="loading-spinner hidden"></div>
                                        <span id="text-lore">Sugerir</span>
                                    </button>
                                </div>
                                <div id="lore-results" class="text-sm bg-black/20 p-4 rounded-xl border border-white/5 min-h-[100px] max-h-[200px] overflow-y-auto whitespace-pre-line"></div>
                            </div>

                            <div class="bg-white/10 p-6 rounded-2xl border border-white/20">
                                <label class="block text-xs font-bold uppercase tracking-widest text-indigo-200 mb-2">Gerador de Copy (Venda)</label>
                                <div class="flex gap-2 mb-4">
                                    <input type="text" id="piece-name" placeholder="Nome do produto para an√∫ncio..." class="flex-grow bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-indigo-300 focus:ring-2 focus:ring-amber-400 focus:outline-none">
                                    <button onclick="generateText('copy')" id="btn-copy" class="bg-indigo-500 hover:bg-indigo-600 px-6 rounded-xl font-bold transition flex items-center justify-center">
                                        <div id="loader-copy" class="loading-spinner hidden"></div>
                                        <span id="text-copy">Criar An√∫ncio</span>
                                    </button>
                                </div>
                                <div id="copy-results" class="text-sm bg-black/20 p-4 rounded-xl border border-white/5 min-h-[100px] max-h-[200px] overflow-y-auto whitespace-pre-line"></div>
                            </div>
                        </div>

                        <!-- Right side: Image Tool -->
                        <div class="w-full lg:w-1/2 flex flex-col h-full">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-bold">Visualiza√ß√£o do Conceito</h3>
                                <button onclick="generateImage()" id="btn-visual" class="bg-white/20 hover:bg-white/30 p-3 rounded-full transition flex items-center justify-center">
                                    <span id="icon-visual">üîÑ</span>
                                    <div id="loader-visual" class="loading-spinner hidden"></div>
                                </button>
                            </div>
                            
                            <div class="image-container flex items-center justify-center shadow-inner border border-white/10">
                                <div id="image-placeholder" class="text-center p-8">
                                    <span class="text-5xl block mb-4">üè∫</span>
                                    <p class="text-sm text-indigo-100">Clique no √≠cone de atualiza√ß√£o para gerar o visual 3D.</p>
                                </div>
                                <img id="generated-image" class="hidden" alt="Concept Art">
                            </div>
                            <p class="mt-4 text-[10px] text-center text-indigo-200 tracking-widest uppercase">Tecnologia Imagen 4.0 - Gerando valor visual</p>
                        </div>

                    </div>
                </div>
            </div>
        </section>

        <!-- Calculator -->
        <section id="calculator" class="scroll-mt-24">
            <div class="bg-lore-dark text-white rounded-[2.5rem] p-8 md:p-16 shadow-2xl">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
                    <div>
                        <h2 class="text-3xl font-display font-bold mb-8">üõ†Ô∏è Calculadora de Lucro</h2>
                        <div class="space-y-6">
                            <div class="grid grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Peso da Pe√ßa (g)</label>
                                    <input type="number" id="weight" value="250" class="w-full bg-gray-800 border-none rounded-xl px-4 py-4 text-white text-xl font-bold focus:ring-2 focus:ring-lore-accent">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Tempo (h)</label>
                                    <input type="number" id="time" value="8" class="w-full bg-gray-800 border-none rounded-xl px-4 py-4 text-white text-xl font-bold focus:ring-2 focus:ring-lore-accent">
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-gray-400 uppercase mb-2">Custo do Filamento (R$/kg)</label>
                                <input type="number" id="fil-cost" value="120" class="w-full bg-gray-800 border-none rounded-xl px-4 py-4 text-white text-xl font-bold focus:ring-2 focus:ring-lore-accent">
                            </div>
                            <div class="p-4 bg-white/5 rounded-xl border border-white/5">
                                <p class="text-xs text-gray-400 italic">Custo operacional base (energia + manuten√ß√£o) estimado em R$ 3,50/hora.</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col justify-center">
                        <div class="bg-white rounded-3xl p-10 text-center shadow-xl">
                            <span class="text-gray-500 uppercase font-bold text-xs tracking-widest mb-2 block">Venda Sugerida (Margem 3x)</span>
                            <div id="res-price" class="text-6xl font-display font-bold text-lore-accent mb-4">R$ 0,00</div>
                            <div class="bg-green-100 text-green-700 py-2 px-6 rounded-full inline-block font-bold">Lucro: <span id="res-profit">R$ 0,00</span></div>
                            
                            <div class="mt-8 pt-8 border-t border-gray-100">
                                <canvas id="chart-costs" class="max-h-48 mx-auto"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Strategy -->
        <section id="strategy" class="scroll-mt-24 grid grid-cols-1 md:grid-cols-2 gap-12">
            <div class="bg-white p-10 rounded-3xl shadow-lg border border-gray-100">
                <h3 class="text-2xl font-display font-bold mb-6 border-b pb-4">A L√≥gica do Faturamento</h3>
                <p class="text-gray-600 mb-4">Para chegar aos <strong>R$ 6.600</strong>, voc√™ n√£o precisa de 1000 vendas. Voc√™ precisa de pe√ßas de alto ticket.</p>
                <ul class="space-y-4">
                    <li class="flex items-center gap-3"><span class="bg-amber-100 text-amber-600 p-2 rounded-lg font-bold">1</span> 22 Vendas de R$ 300,00</li>
                    <li class="flex items-center gap-3"><span class="bg-amber-100 text-amber-600 p-2 rounded-lg font-bold">2</span> Foque no acabamento manual (pintura/efeitos)</li>
                    <li class="flex items-center gap-3"><span class="bg-amber-100 text-amber-600 p-2 rounded-lg font-bold">3</span> Venda a hist√≥ria, use o Copywriter de IA</li>
                </ul>
            </div>
            <div class="bg-white p-10 rounded-3xl shadow-lg border border-gray-100">
                <h3 class="text-2xl font-display font-bold mb-6 border-b pb-4">Hardware Ideal</h3>
                <div class="space-y-6">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-bold">Bambu Lab A1 Combo</p>
                            <p class="text-xs text-gray-500">Multicolor nativo, precis√£o absurda.</p>
                        </div>
                        <span class="text-green-600 font-bold text-sm">RECOMENDADO</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-bold">Kobra 3 Combo</p>
                            <p class="text-xs text-gray-500">Custo-benef√≠cio e secador integrado.</p>
                        </div>
                        <span class="text-blue-600 font-bold text-sm">ECON√îMICO</span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // --- API & State Management ---
        let API_KEY = localStorage.getItem('GEMINI_API_KEY') || "";
        let costChart = null;

        function toggleModal(show) {
            const modal = document.getElementById('api-modal');
            modal.classList.toggle('hidden', !show);
            if (show) document.getElementById('api-key-input').value = API_KEY;
        }

        function saveApiKey() {
            const val = document.getElementById('api-key-input').value.trim();
            if (!val) return alert("Insira uma chave v√°lida!");
            API_KEY = val;
            localStorage.setItem('GEMINI_API_KEY', val);
            toggleModal(false);
            alert("Chave salva localmente!");
        }

        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Gemini Service ---
        async function fetchGemini(endpoint, payload) {
            if (!API_KEY) {
                toggleModal(true);
                throw new Error("API Key missing");
            }
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${endpoint}?key=${API_KEY}`;
            
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error("Erro na API");
                    return await response.json();
                } catch (e) {
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
            throw new Error("Falha ap√≥s tentativas");
        }

        // --- Logic Handlers ---
        async function generateText(type) {
            const inputId = type === 'lore' ? 'lore-theme' : 'piece-name';
            const outputId = type === 'lore' ? 'lore-results' : 'copy-results';
            const loaderId = type === 'lore' ? 'loader-lore' : 'loader-copy';
            const textId = type === 'lore' ? 'text-lore' : 'text-copy';
            
            const promptInput = document.getElementById(inputId).value;
            if (!promptInput) return alert("Preencha o campo primeiro!");

            const loader = document.getElementById(loaderId);
            const textSpan = document.getElementById(textId);
            const output = document.getElementById(outputId);

            loader.classList.remove('hidden');
            textSpan.classList.add('hidden');
            output.innerText = "Consultando a IA...";

            const systemPrompt = type === 'lore' 
                ? "Voc√™ √© um consultor criativo de impress√£o 3D nerd adulta. Gere 3 ideias de artefatos √©picos (n√£o bonecos) baseados no tema."
                : "Voc√™ √© um mestre de copy para produtos nerds exclusivos. Gere um an√∫ncio emocionante focado em nostalgia.";

            try {
                const data = await fetchGemini('gemini-2.5-flash-preview-09-2025:generateContent', {
                    contents: [{ parts: [{ text: promptInput }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] }
                });
                output.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Erro na resposta.";
            } catch (e) {
                output.innerText = "Erro ao conectar. Verifique sua chave API.";
            } finally {
                loader.classList.add('hidden');
                textSpan.classList.remove('hidden');
            }
        }

        async function generateImage() {
            const theme = document.getElementById('lore-theme').value || "Nerd Artifact decoration 3d printed";
            const loader = document.getElementById('loader-visual');
            const icon = document.getElementById('icon-visual');
            const img = document.getElementById('generated-image');
            const placeholder = document.getElementById('image-placeholder');

            loader.classList.remove('hidden');
            icon.classList.add('hidden');

            const prompt = `Highly detailed 3D printed artifact, lore-rich, nostalgic nerd decor, realistic materials, cinematic lighting, 16:9 ratio, themed as: ${theme}`;

            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${API_KEY}`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ instances: { prompt: prompt }, parameters: { sampleCount: 1 } })
                });
                const data = await response.json();
                
                if (data.predictions?.[0]) {
                    img.src = `data:image/png;base64,${data.predictions[0].bytesBase64Encoded}`;
                    img.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                }
            } catch (e) {
                alert("Erro ao gerar imagem. Verifique sua chave API.");
            } finally {
                loader.classList.add('hidden');
                icon.classList.remove('hidden');
            }
        }

        // --- Calculator Engine ---
        function calculate() {
            const weight = parseFloat(document.getElementById('weight').value) || 0;
            const time = parseFloat(document.getElementById('time').value) || 0;
            const filCost = parseFloat(document.getElementById('fil-cost').value) || 0;

            const matCost = (weight / 1000) * filCost;
            const operationalCost = time * 3.5;
            const totalCost = matCost + operationalCost;

            const sellPrice = totalCost * 3.5; // Margem de 250%
            const profit = sellPrice - totalCost;

            document.getElementById('res-price').innerText = sellPrice.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('res-profit').innerText = profit.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            updateChart(matCost, operationalCost, profit);
        }

        function updateChart(mat, ops, pro) {
            const ctx = document.getElementById('chart-costs').getContext('2d');
            if (costChart) costChart.destroy();
            
            costChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Material', 'Opera√ß√£o', 'Lucro'],
                    datasets: [{
                        data: [mat, ops, pro],
                        backgroundColor: ['#fbbf24', '#475569', '#10b981'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom', labels: { font: { size: 10 } } } }
                }
            });
        }

        // --- Init ---
        window.onload = () => {
            calculate();
            document.querySelectorAll('input').forEach(i => i.addEventListener('input', calculate));
            if (!API_KEY) toggleModal(true);
        };
    </script>
</body>
</html>    <style>
        body { background-color: #f5f5f0; color: #2d3748; }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: auto; height: 300px; }
        .gemini-gradient { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #d97706 100%); }
        
        .loading-spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid #fff;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .image-aspect-ratio {
            aspect-ratio: 16 / 9;
            width: 100%;
            object-fit: cover;
            border-radius: 1rem;
        }
    </style>
</head>
<body class="font-sans antialiased">

    <nav class="bg-white border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-display font-bold text-lore-dark">Forge<span class="text-lore-accent">3D</span> Planner</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="scrollToSection('strategy')" class="text-sm font-medium hover:text-lore-accent transition">Estrat√©gia</button>
                    <button onclick="scrollToSection('ai-center')" class="text-sm font-bold text-indigo-600 hover:text-indigo-800 transition">‚ú® IA Visual</button>
                    <button onclick="scrollToSection('calculator')" class="bg-lore-accent text-white px-4 py-2 rounded-md text-sm font-bold shadow-sm">Calculadora</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-16">

        <!-- Hero -->
        <section class="text-center py-8">
            <h1 class="text-4xl md:text-5xl font-display font-bold text-lore-dark mb-4">
                Neg√≥cio de Impress√£o 3D: <span class="text-lore-accent">Nicho de Lore</span>
            </h1>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto">Visualize, planeje e lucre com itens de decora√ß√£o para o p√∫blico nerd adulto.</p>
        </section>

        <!-- ‚ú® AI CENTER SECTION -->
        <section id="ai-center" class="scroll-mt-24">
            <div class="gemini-gradient p-8 md:p-12 rounded-3xl text-white shadow-xl">
                <div class="flex flex-col md:flex-row justify-between items-start mb-8 gap-4">
                    <div>
                        <h2 class="text-3xl font-display font-bold mb-2 flex items-center gap-2">‚ú® Central de Intelig√™ncia Lore</h2>
                        <p class="text-indigo-100 max-w-xl">Crie conceitos visuais e textos de venda em segundos.</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Left: Inputs and Text Output -->
                    <div class="space-y-6">
                        <div class="bg-white/10 p-6 rounded-2xl border border-white/20 backdrop-blur-sm">
                            <h3 class="text-xl font-bold mb-4">Gerador de Conceitos</h3>
                            <div class="flex gap-2 mb-4">
                                <input type="text" id="lore-theme" placeholder="Tema (ex: Dark Souls, Cyberpunk, LOTR...)" class="flex-grow bg-white/20 border border-white/30 rounded-lg px-4 py-2 text-white placeholder-indigo-200 focus:outline-none focus:ring-2 focus:ring-amber-400">
                                <button onclick="generateLoreIdeas()" id="btn-lore" class="bg-amber-500 hover:bg-amber-600 px-6 py-2 rounded-lg font-bold transition flex items-center gap-2">
                                    <span>Gerar Ideias</span>
                                    <div id="loader-lore" class="loading-spinner hidden"></div>
                                </button>
                            </div>
                            <div id="lore-results" class="bg-black/20 rounded-xl p-4 text-sm min-h-[120px] max-h-[250px] overflow-y-auto italic text-indigo-50 border border-white/5">
                                As ideias de produtos aparecer√£o aqui...
                            </div>
                        </div>

                        <div class="bg-white/10 p-6 rounded-2xl border border-white/20 backdrop-blur-sm">
                            <h3 class="text-xl font-bold mb-4">Copy de Venda</h3>
                            <input type="text" id="piece-name" placeholder="Nome da pe√ßa para o an√∫ncio" class="w-full bg-white/20 border border-white/30 rounded-lg px-4 py-2 text-white mb-4">
                            <button onclick="generateSalesCopy()" id="btn-copy" class="w-full bg-indigo-500 hover:bg-indigo-600 py-3 rounded-lg font-bold transition flex justify-center items-center gap-2">
                                <span>Criar An√∫ncio</span>
                                <div id="loader-copy" class="loading-spinner hidden"></div>
                            </button>
                            <div id="copy-results" class="mt-4 bg-black/20 rounded-xl p-4 text-sm min-h-[100px] text-indigo-50 border border-white/5 whitespace-pre-line"></div>
                        </div>
                    </div>

                    <!-- Right: Visual Generator -->
                    <div class="bg-white/10 p-6 rounded-2xl border border-white/20 backdrop-blur-sm flex flex-col h-full">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Visualiza√ß√£o do Artefato</h3>
                            <button onclick="generateVisual()" id="btn-visual" class="bg-white/20 hover:bg-white/30 p-2 rounded-full transition title='Gerar/Atualizar Imagem'">
                                <span id="refresh-icon">üîÑ</span>
                                <div id="loader-visual" class="loading-spinner hidden"></div>
                            </button>
                        </div>
                        
                        <div id="image-container" class="relative flex-grow bg-black/30 rounded-2xl border border-white/10 flex items-center justify-center overflow-hidden min-h-[300px]">
                            <div id="image-placeholder" class="text-center p-8">
                                <span class="text-4xl mb-2 block">üñºÔ∏è</span>
                                <p class="text-sm text-indigo-200">Clique no √≠cone de atualiza√ß√£o acima para gerar o conceito visual baseado no tema escolhido.</p>
                            </div>
                            <img id="generated-image" class="image-aspect-ratio hidden" alt="Conceito do Artefato">
                            
                            <div id="image-status" class="absolute bottom-4 left-4 right-4 bg-black/60 backdrop-blur-sm px-3 py-1 rounded text-xs text-white opacity-0 transition-opacity">
                                Gerando imagem...
                            </div>
                        </div>
                        <p class="text-[10px] text-indigo-300 mt-2 text-center uppercase tracking-widest">Conceito gerado por Imagen 4.0</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Strategy Section -->
        <section id="strategy" class="scroll-mt-24">
            <div class="mb-8">
                <h2 class="text-3xl font-display font-bold text-lore-dark mb-4">1. O Nicho: Decora√ß√£o Nerd "Grown-Up"</h2>
                <p class="text-lg text-gray-600 max-w-4xl">
                    Para atingir sua meta de R$ 6.600, voc√™ precisa de margem de lucro, n√£o apenas volume. O nicho "Action Figures" est√° saturado. O nicho <strong>"Lore & Artifacts"</strong> foca na experi√™ncia, na imers√£o e na decora√ß√£o funcional para adultos nost√°lgicos.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-2xl card-shadow">
                    <h3 class="text-xl font-bold text-lore-dark mb-4 border-b pb-2">Produtos de Alto Valor (Lore)</h3>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="text-2xl mr-3">üîÆ</span>
                            <div>
                                <strong class="text-lore-accent">Ilumina√ß√£o Tem√°tica:</strong>
                                <p class="text-sm text-gray-600">Lumin√°rias de cristais, tochas de RPG, letreiros neon-style de Cyberpunk. Valor percebido alto (R$ 150 - R$ 400).</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-2xl mr-3">üìú</span>
                            <div>
                                <strong class="text-lore-accent">Props Funcionais:</strong>
                                <p class="text-sm text-gray-600">Suportes de fone em formato de caveira, bookends (aparadores de livro) de portais m√°gicos, caixas de dados.</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="bg-lore-stone/50 p-8 rounded-2xl border border-stone-200">
                    <h3 class="text-xl font-bold text-lore-dark mb-4 border-b border-stone-300 pb-2">O Cliente Ideal</h3>
                    <div class="space-y-4">
                        <p class="text-gray-700"><strong>Perfil:</strong> Adulto (25-45 anos), renda est√°vel, trabalha em √°reas criativas.</p>
                        <p class="text-gray-700"><strong>Dores:</strong> Busca exclusividade. Quer decorar o escrit√≥rio/setup gamer com itens que contam hist√≥rias.</p>
                        <div class="bg-white p-4 rounded-lg mt-4 text-sm text-lore-dark font-medium border-l-4 border-lore-accent">
                            üí° Dica: A pintura e o acabamento (p√≥s-processamento) agregam 200% ao valor da pe√ßa.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Hardware Comparison -->
        <section id="hardware" class="scroll-mt-24">
            <div class="mb-8">
                <h2 class="text-3xl font-display font-bold text-lore-dark mb-4">2. Ferramentas para Produ√ß√£o Comercial</h2>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Bambu Lab A1 -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-green-600 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 bg-green-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg">Ecossistema Fechado</div>
                    <h3 class="text-2xl font-bold mb-2">Bambu Lab A1 Combo</h3>
                    <div class="text-3xl font-display font-bold text-gray-800 mb-4">~R$ 4.800</div>
                    <button onclick="selectPrinter('bambu')" class="w-full py-2 bg-gray-100 hover:bg-green-50 text-green-700 font-bold rounded-lg transition">Selecionar</button>
                </div>

                <!-- Comparison Chart -->
                <div class="bg-white p-4 rounded-xl card-shadow flex flex-col items-center justify-center">
                    <div class="chart-container h-64">
                        <canvas id="printerRadarChart"></canvas>
                    </div>
                </div>

                <!-- Kobra 3 -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-blue-600 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg">Custo Benef√≠cio</div>
                    <h3 class="text-2xl font-bold mb-2">Anycubic Kobra 3 Combo</h3>
                    <div class="text-3xl font-display font-bold text-gray-800 mb-4">~R$ 3.600</div>
                    <button onclick="selectPrinter('kobra')" class="w-full py-2 bg-gray-100 hover:bg-blue-50 text-blue-700 font-bold rounded-lg transition">Selecionar</button>
                </div>
            </div>
        </section>

        <!-- The Forge: Calculator -->
        <section id="calculator" class="scroll-mt-24">
             <div class="bg-lore-dark text-white rounded-3xl p-8 md:p-12 shadow-2xl relative overflow-hidden">
                <div class="absolute top-0 right-0 w-64 h-64 bg-lore-accent opacity-10 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2"></div>
                <h2 class="text-3xl font-display font-bold mb-8 relative z-10">üõ†Ô∏è A Forja: Calculadora de Custos</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 relative z-10">
                    <div class="space-y-6">
                        <div class="bg-white/10 p-6 rounded-xl backdrop-blur-sm border border-white/10">
                            <h3 class="text-lg font-bold text-lore-accent mb-4">Configura√ß√µes da Pe√ßa</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Peso (gramas)</label>
                                    <input type="number" id="partWeight" value="150" class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:border-lore-accent">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Tempo de Impress√£o (h)</label>
                                    <input type="number" id="printTime" value="6.5" class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:border-lore-accent">
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-xs text-gray-400 mb-1">Pre√ßo do Filamento (R$/kg)</label>
                                    <input type="number" id="filamentCost" value="110" class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:border-lore-accent">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white text-lore-dark rounded-xl p-8 flex flex-col justify-center text-center card-shadow">
                        <div class="text-xs text-gray-500 uppercase font-bold mb-1">Pre√ßo de Venda Sugerido</div>
                        <div class="text-6xl font-display font-bold text-lore-accent mb-4" id="res-sell-price">R$ 0,00</div>
                        <div class="text-sm text-green-600 font-bold bg-green-50 py-2 px-4 rounded-full inline-block mx-auto">
                            Lucro por pe√ßa: <span id="res-profit">R$ 0,00</span>
                        </div>
                        <div class="mt-6 pt-6 border-t border-gray-100 flex justify-around text-sm">
                            <div class="text-gray-400">Custo Total: <span id="res-cost-display" class="text-lore-dark font-bold">R$ 0,00</span></div>
                        </div>
                    </div>
                </div>

                <div class="mt-12 bg-white/5 rounded-2xl p-6 border border-white/5">
                    <h3 class="text-center text-sm font-bold text-gray-400 uppercase tracking-widest mb-6">Composi√ß√£o Financeira</h3>
                    <div class="chart-container h-48 w-full">
                        <canvas id="costBreakdownChart"></canvas>
                    </div>
                </div>
             </div>
        </section>

    </main>

    <footer class="bg-lore-dark text-white py-8 mt-12 text-center">
        <p class="text-sm text-gray-400">Forge3D Planner - Intelig√™ncia Artificial aplicada ao seu neg√≥cio.</p>
    </footer>

    <script>
        const apiKey = ""; // Chave fornecida pelo ambiente

        // --- NAVIGATION SAFETY ---
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            } else {
                console.warn(`Se√ß√£o com ID '${id}' n√£o encontrada.`);
            }
        }

        // --- GEMINI & IMAGEN INTEGRATION ---
        async function fetchWithRetry(url, payload, retries = 5) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('Falha na requisi√ß√£o');
                    return await response.json();
                } catch (e) {
                    if (i === retries - 1) throw e;
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
        }

        async function generateLoreIdeas() {
            const theme = document.getElementById('lore-theme').value || "Nostalgia Nerd";
            const btn = document.getElementById('btn-lore');
            const loader = document.getElementById('loader-lore');
            const output = document.getElementById('lore-results');

            btn.disabled = true;
            loader.classList.remove('hidden');
            output.innerText = "Consultando arquivos...";

            const systemPrompt = "Voc√™ √© um especialista em design de produtos 3D nerd adultos. Sugira 3 artefatos decorativos (n√£o bonecos) funcionais ou √©picos baseados no tema. Seja criativo.";
            const userPrompt = `Gere 3 ideias para o tema: ${theme}. D√™ nomes impactantes e explique o lore b√°sico.`;

            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                const data = await fetchWithRetry(url, {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] }
                });
                output.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Erro ao gerar.";
            } catch (e) {
                output.innerText = "Erro na conex√£o com a IA.";
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }

        async function generateVisual() {
            const theme = document.getElementById('lore-theme').value || "Nerd Artifact";
            const loader = document.getElementById('loader-visual');
            const icon = document.getElementById('refresh-icon');
            const imgElement = document.getElementById('generated-image');
            const placeholder = document.getElementById('image-placeholder');
            const status = document.getElementById('image-status');

            loader.classList.remove('hidden');
            icon.classList.add('hidden');
            status.style.opacity = "1";
            status.innerText = "Imaginando artefatos...";

            const promptText = `A highly detailed 3D printed artifact for home decor, theme: ${theme}. It should be a functional or decorative object like a magical lamp, a mechanical bookend, or a gothic wall relief. High-end finish, atmospheric lighting, cinematic composition, photorealistic, 16:9 widescreen format, no people, focus on texture and lore.`;

            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`;
                const data = await fetchWithRetry(url, {
                    instances: { prompt: promptText },
                    parameters: { sampleCount: 1 }
                });

                if (data.predictions && data.predictions[0]) {
                    const b64 = data.predictions[0].bytesBase64Encoded;
                    imgElement.src = `data:image/png;base64,${b64}`;
                    imgElement.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                    status.innerText = "Conceito Visual Gerado.";
                }
            } catch (e) {
                status.innerText = "Erro ao gerar imagem.";
            } finally {
                loader.classList.add('hidden');
                icon.classList.remove('hidden');
                setTimeout(() => status.style.opacity = "0", 3000);
            }
        }

        async function generateSalesCopy() {
            const piece = document.getElementById('piece-name').value || "Artefato";
            const btn = document.getElementById('btn-copy');
            const loader = document.getElementById('loader-copy');
            const output = document.getElementById('copy-results');

            btn.disabled = true;
            loader.classList.remove('hidden');

            const prompt = `Crie um an√∫ncio magn√©tico para o Instagram sobre a pe√ßa "${piece}". Foque em nostalgia, exclusividade e na hist√≥ria que essa pe√ßa conta no setup do cliente.`;
            
            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                const data = await fetchWithRetry(url, {
                    contents: [{ parts: [{ text: prompt }] }]
                });
                output.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Erro ao criar an√∫ncio.";
            } catch (e) {
                output.innerText = "Erro de conex√£o.";
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }

        // --- CALCULATOR LOGIC ---
        function updateCalcs() {
            const weight = parseFloat(document.getElementById('partWeight').value) || 0;
            const time = parseFloat(document.getElementById('printTime').value) || 0;
            const filCost = parseFloat(document.getElementById('filamentCost').value) || 0;
            
            const matCost = (weight / 1000) * filCost;
            const machineCost = time * 3.5; // M√©dia de energia + deprecia√ß√£o
            const totalCost = (matCost + machineCost) * 1.1; // +10% de margem de erro
            
            const sellPrice = totalCost * 3.5; // Margem de 250%
            const profit = sellPrice - totalCost;

            document.getElementById('res-sell-price').innerText = sellPrice.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('res-profit').innerText = profit.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            document.getElementById('res-cost-display').innerText = totalCost.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            updateDonut(matCost, machineCost, profit);
        }

        // --- CHARTS INITIALIZATION ---
        let radarChart, costChart;

        window.onload = function() {
            const ctxRadar = document.getElementById('printerRadarChart').getContext('2d');
            radarChart = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['Velocidade', 'Confiabilidade', 'Custo-Benef√≠cio', 'Facilidade', 'Ecossistema', 'Multicolor'],
                    datasets: [
                        { label: 'Bambu A1', data: [9, 10, 7, 9, 10, 9], borderColor: 'rgb(22, 163, 74)', backgroundColor: 'rgba(22, 163, 74, 0.2)' },
                        { label: 'Kobra 3', data: [8, 7, 10, 7, 6, 8], borderColor: 'rgb(37, 99, 235)', backgroundColor: 'rgba(37, 99, 235, 0.2)' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            const ctxDonut = document.getElementById('costBreakdownChart').getContext('2d');
            costChart = new Chart(ctxDonut, {
                type: 'doughnut',
                data: {
                    labels: ['Material', 'Produ√ß√£o/Energia', 'Lucro L√≠quido'],
                    datasets: [{ data: [30, 20, 50], backgroundColor: ['#d97706', '#475569', '#10b981'], borderWidth: 0 }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { position: 'bottom', labels: { color: '#94a3b8', font: { size: 10 } } } 
                    } 
                }
            });

            updateCalcs();
        };

        function updateDonut(mat, mac, pro) {
            if (costChart) {
                costChart.data.datasets[0].data = [mat, mac, pro];
                costChart.update();
            }
        }

        function selectPrinter(k) {
            // Ajustes simulados baseados na m√°quina
            const timeInput = document.getElementById('printTime');
            if(k === 'bambu') { 
                timeInput.value = (parseFloat(timeInput.value) * 0.9).toFixed(1); // Mais r√°pida
            } else { 
                timeInput.value = (parseFloat(timeInput.value) * 1.1).toFixed(1); 
            }
            updateCalcs();
        }

        document.querySelectorAll('input').forEach(i => i.addEventListener('input', updateCalcs));
    </script>
</body>
</html>
